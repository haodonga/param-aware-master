wandb: Currently logged in as: 910877690 (ycx). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.18.3 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /workspace/Edge_popup/hidden-networks-master/wandb/run-20241011_161159-hl1fk7gm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run open_finetune_1e-05_unif_0.5_CIFAR10_cResNet18_512_1
wandb: ⭐️ View project at https://wandb.ai/ycx/EP%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92
wandb: 🚀 View run at https://wandb.ai/ycx/EP%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/runs/hl1fk7gm
wandb: logging graph, to disable use `wandb.watch(log_graph=False)`
=> Reading YAML config from configs/smallscale/resnet18/resnet18-usc-unsigned.yaml
Namespace(arch='cResNet18', batch_size=512, bn_type='NonAffineBatchNorm', config='configs/smallscale/resnet18/resnet18-usc-unsigned.yaml', conv_type='SubnetConv', data='dataset', epochs=1, evaluate=False, finetune=True, finetune_aftertrain=False, first_layer_dense=False, first_layer_type=None, freeze_weights=True, init='signed_constant', label_smoothing=None, last_layer_dense=False, log_dir=None, low_data=1, lr=0.1, lr_policy='cosine_lr', mode='fan_in', momentum=0.9, multigpu=[0], multistep_lr_adjust=30, multistep_lr_gamma=0.1, name='scores_open', nesterov=False, no_bn_decay=False, nonlinearity='relu', num_classes=10, one_batch=False, optimizer='sgd', pretrained=None, print_freq=10, prune_rate=0.5, random_subnet=False, resume='', save_every=-1, scale_fan=False, score_init_constant=None, scores_lambda=1e-05, seed=None, set='CIFAR10', start_epoch=None, trainer='default', warmup_length=0, weight_decay=0.0005, width_mult=1.0, workers=4)
=> Using trainer from trainers.default
=> Creating model 'cResNet18'
==> Conv Type: SubnetConv
==> BN Type: NonAffineBatchNorm
==> Building first layer with <class 'utils.conv_type.SubnetConv'>
==> Setting prune rate of network to 0.5
==> Setting prune rate of conv1 to 0.5
==> Setting prune rate of layer1.0.conv1 to 0.5
==> Setting prune rate of layer1.0.conv2 to 0.5
==> Setting prune rate of layer1.1.conv1 to 0.5
==> Setting prune rate of layer1.1.conv2 to 0.5
==> Setting prune rate of layer2.0.conv1 to 0.5
==> Setting prune rate of layer2.0.conv2 to 0.5
==> Setting prune rate of layer2.0.shortcut.0 to 0.5
==> Setting prune rate of layer2.1.conv1 to 0.5
==> Setting prune rate of layer2.1.conv2 to 0.5
==> Setting prune rate of layer3.0.conv1 to 0.5
==> Setting prune rate of layer3.0.conv2 to 0.5
==> Setting prune rate of layer3.0.shortcut.0 to 0.5
==> Setting prune rate of layer3.1.conv1 to 0.5
==> Setting prune rate of layer3.1.conv2 to 0.5
==> Setting prune rate of layer4.0.conv1 to 0.5
==> Setting prune rate of layer4.0.conv2 to 0.5
==> Setting prune rate of layer4.0.shortcut.0 to 0.5
==> Setting prune rate of layer4.1.conv1 to 0.5
==> Setting prune rate of layer4.1.conv2 to 0.5
==> Setting prune rate of fc to 0.5
=> Rough estimate model params 5582176
=> Freezing model weights
==> No gradient to conv1.weight
==> No gradient to layer1.0.conv1.weight
==> No gradient to layer1.0.conv2.weight
==> No gradient to layer1.1.conv1.weight
==> No gradient to layer1.1.conv2.weight
==> No gradient to layer2.0.conv1.weight
==> No gradient to layer2.0.conv2.weight
==> No gradient to layer2.0.shortcut.0.weight
==> No gradient to layer2.1.conv1.weight
==> No gradient to layer2.1.conv2.weight
==> No gradient to layer3.0.conv1.weight
==> No gradient to layer3.0.conv2.weight
==> No gradient to layer3.0.shortcut.0.weight
==> No gradient to layer3.1.conv1.weight
==> No gradient to layer3.1.conv2.weight
==> No gradient to layer4.0.conv1.weight
==> No gradient to layer4.0.conv2.weight
==> No gradient to layer4.0.shortcut.0.weight
==> No gradient to layer4.1.conv1.weight
==> No gradient to layer4.1.conv2.weight
==> No gradient to fc.weight
=> Parallelizing on [0] gpus
<DEBUG> no gradient to module.conv1.weight
<DEBUG> gradient to module.conv1.scores
<DEBUG> no gradient to module.layer1.0.conv1.weight
<DEBUG> gradient to module.layer1.0.conv1.scores
<DEBUG> no gradient to module.layer1.0.conv2.weight
<DEBUG> gradient to module.layer1.0.conv2.scores
<DEBUG> no gradient to module.layer1.1.conv1.weight
<DEBUG> gradient to module.layer1.1.conv1.scores
<DEBUG> no gradient to module.layer1.1.conv2.weight
<DEBUG> gradient to module.layer1.1.conv2.scores
<DEBUG> no gradient to module.layer2.0.conv1.weight
<DEBUG> gradient to module.layer2.0.conv1.scores
<DEBUG> no gradient to module.layer2.0.conv2.weight
<DEBUG> gradient to module.layer2.0.conv2.scores
<DEBUG> no gradient to module.layer2.0.shortcut.0.weight
<DEBUG> gradient to module.layer2.0.shortcut.0.scores
<DEBUG> no gradient to module.layer2.1.conv1.weight
<DEBUG> gradient to module.layer2.1.conv1.scores
<DEBUG> no gradient to module.layer2.1.conv2.weight
<DEBUG> gradient to module.layer2.1.conv2.scores
<DEBUG> no gradient to module.layer3.0.conv1.weight
<DEBUG> gradient to module.layer3.0.conv1.scores
<DEBUG> no gradient to module.layer3.0.conv2.weight
<DEBUG> gradient to module.layer3.0.conv2.scores
<DEBUG> no gradient to module.layer3.0.shortcut.0.weight
<DEBUG> gradient to module.layer3.0.shortcut.0.scores
<DEBUG> no gradient to module.layer3.1.conv1.weight
<DEBUG> gradient to module.layer3.1.conv1.scores
<DEBUG> no gradient to module.layer3.1.conv2.weight
<DEBUG> gradient to module.layer3.1.conv2.scores
<DEBUG> no gradient to module.layer4.0.conv1.weight
<DEBUG> gradient to module.layer4.0.conv1.scores
<DEBUG> no gradient to module.layer4.0.conv2.weight
<DEBUG> gradient to module.layer4.0.conv2.scores
<DEBUG> no gradient to module.layer4.0.shortcut.0.weight
<DEBUG> gradient to module.layer4.0.shortcut.0.scores
<DEBUG> no gradient to module.layer4.1.conv1.weight
<DEBUG> gradient to module.layer4.1.conv1.scores
<DEBUG> no gradient to module.layer4.1.conv2.weight
<DEBUG> gradient to module.layer4.1.conv2.scores
<DEBUG> no gradient to module.fc.weight
<DEBUG> gradient to module.fc.scores
=> Getting CIFAR10 dataset
Files already downloaded and verified
Files already downloaded and verified
  0%|          | 0/98 [00:00<?, ?it/s]                                        0%|          | 0/98 [00:03<?, ?it/s]  1%|1         | 1/98 [00:03<05:31,  3.42s/it]  2%|2         | 2/98 [00:04<02:53,  1.81s/it]  3%|3         | 3/98 [00:04<01:56,  1.22s/it]  4%|4         | 4/98 [00:05<01:28,  1.06it/s]  5%|5         | 5/98 [00:05<01:13,  1.26it/s]  6%|6         | 6/98 [00:06<01:04,  1.43it/s]  7%|7         | 7/98 [00:06<01:00,  1.51it/s]  8%|8         | 8/98 [00:07<00:55,  1.61it/s]  9%|9         | 9/98 [00:07<00:52,  1.70it/s] 10%|#         | 10/98 [00:08<00:49,  1.77it/s]                                                10%|#         | 10/98 [00:08<00:49,  1.77it/s] 11%|#1        | 11/98 [00:08<00:47,  1.81it/s] 12%|#2        | 12/98 [00:09<00:47,  1.81it/s] 13%|#3        | 13/98 [00:09<00:46,  1.85it/s] 14%|#4        | 14/98 [00:10<00:44,  1.87it/s] 15%|#5        | 15/98 [00:10<00:44,  1.88it/s] 16%|#6        | 16/98 [00:11<00:43,  1.90it/s] 17%|#7        | 17/98 [00:12<00:43,  1.86it/s] 18%|#8        | 18/98 [00:12<00:42,  1.89it/s] 19%|#9        | 19/98 [00:13<00:41,  1.91it/s] 20%|##        | 20/98 [00:13<00:40,  1.92it/s]                                                20%|##        | 20/98 [00:14<00:40,  1.92it/s] 21%|##1       | 21/98 [00:14<00:40,  1.92it/s] 22%|##2       | 22/98 [00:14<00:40,  1.86it/s] 23%|##3       | 23/98 [00:15<00:39,  1.88it/s] 24%|##4       | 24/98 [00:15<00:38,  1.90it/s] 26%|##5       | 25/98 [00:16<00:38,  1.92it/s] 27%|##6       | 26/98 [00:16<00:37,  1.93it/s] 28%|##7       | 27/98 [00:17<00:38,  1.87it/s] 29%|##8       | 28/98 [00:17<00:37,  1.89it/s] 30%|##9       | 29/98 [00:18<00:36,  1.89it/s] 31%|###       | 30/98 [00:18<00:35,  1.90it/s]                                                31%|###       | 30/98 [00:19<00:35,  1.90it/s] 32%|###1      | 31/98 [00:19<00:35,  1.90it/s] 33%|###2      | 32/98 [00:19<00:35,  1.88it/s] 34%|###3      | 33/98 [00:20<00:34,  1.90it/s] 35%|###4      | 34/98 [00:20<00:33,  1.91it/s] 36%|###5      | 35/98 [00:21<00:32,  1.91it/s] 37%|###6      | 36/98 [00:22<00:32,  1.91it/s] 38%|###7      | 37/98 [00:22<00:32,  1.88it/s] 39%|###8      | 38/98 [00:23<00:31,  1.90it/s] 40%|###9      | 39/98 [00:23<00:30,  1.92it/s] 41%|####      | 40/98 [00:24<00:30,  1.93it/s]                                                41%|####      | 40/98 [00:24<00:30,  1.93it/s] 42%|####1     | 41/98 [00:24<00:29,  1.93it/s] 43%|####2     | 42/98 [00:25<00:30,  1.86it/s] 44%|####3     | 43/98 [00:25<00:29,  1.87it/s] 45%|####4     | 44/98 [00:26<00:28,  1.90it/s] 46%|####5     | 45/98 [00:26<00:27,  1.91it/s] 47%|####6     | 46/98 [00:27<00:27,  1.91it/s] 48%|####7     | 47/98 [00:27<00:27,  1.87it/s] 49%|####8     | 48/98 [00:28<00:26,  1.89it/s] 50%|#####     | 49/98 [00:28<00:25,  1.90it/s] 51%|#####1    | 50/98 [00:29<00:25,  1.90it/s]                                                51%|#####1    | 50/98 [00:29<00:25,  1.90it/s] 52%|#####2    | 51/98 [00:29<00:24,  1.91it/s] 53%|#####3    | 52/98 [00:30<00:24,  1.87it/s] 54%|#####4    | 53/98 [00:30<00:23,  1.90it/s] 55%|#####5    | 54/98 [00:31<00:23,  1.91it/s] 56%|#####6    | 55/98 [00:32<00:22,  1.93it/s] 57%|#####7    | 56/98 [00:32<00:21,  1.93it/s] 58%|#####8    | 57/98 [00:33<00:22,  1.85it/s] 59%|#####9    | 58/98 [00:33<00:21,  1.88it/s] 60%|######    | 59/98 [00:34<00:20,  1.90it/s] 61%|######1   | 60/98 [00:34<00:19,  1.91it/s]                                                61%|######1   | 60/98 [00:35<00:19,  1.91it/s] 62%|######2   | 61/98 [00:35<00:19,  1.91it/s] 63%|######3   | 62/98 [00:35<00:19,  1.87it/s] 64%|######4   | 63/98 [00:36<00:18,  1.86it/s] 65%|######5   | 64/98 [00:36<00:18,  1.88it/s] 66%|######6   | 65/98 [00:37<00:17,  1.90it/s] 67%|######7   | 66/98 [00:37<00:16,  1.91it/s] 68%|######8   | 67/98 [00:38<00:16,  1.88it/s] 69%|######9   | 68/98 [00:38<00:15,  1.89it/s] 70%|#######   | 69/98 [00:39<00:15,  1.91it/s] 71%|#######1  | 70/98 [00:39<00:14,  1.92it/s]                                                71%|#######1  | 70/98 [00:40<00:14,  1.92it/s] 72%|#######2  | 71/98 [00:40<00:14,  1.92it/s] 73%|#######3  | 72/98 [00:41<00:13,  1.87it/s] 74%|#######4  | 73/98 [00:41<00:13,  1.89it/s] 76%|#######5  | 74/98 [00:42<00:12,  1.91it/s] 77%|#######6  | 75/98 [00:42<00:11,  1.92it/s] 78%|#######7  | 76/98 [00:43<00:11,  1.93it/s] 79%|#######8  | 77/98 [00:43<00:11,  1.86it/s] 80%|#######9  | 78/98 [00:44<00:10,  1.87it/s] 81%|########  | 79/98 [00:44<00:10,  1.89it/s] 82%|########1 | 80/98 [00:45<00:09,  1.91it/s]                                                82%|########1 | 80/98 [00:45<00:09,  1.91it/s] 83%|########2 | 81/98 [00:45<00:08,  1.92it/s] 84%|########3 | 82/98 [00:46<00:08,  1.88it/s] 85%|########4 | 83/98 [00:46<00:07,  1.89it/s] 86%|########5 | 84/98 [00:47<00:07,  1.91it/s] 87%|########6 | 85/98 [00:47<00:06,  1.91it/s] 88%|########7 | 86/98 [00:48<00:06,  1.92it/s] 89%|########8 | 87/98 [00:48<00:05,  1.86it/s] 90%|########9 | 88/98 [00:49<00:05,  1.88it/s] 91%|######### | 89/98 [00:49<00:04,  1.90it/s] 92%|#########1| 90/98 [00:50<00:04,  1.92it/s]                                                92%|#########1| 90/98 [00:50<00:04,  1.92it/s] 93%|#########2| 91/98 [00:50<00:03,  1.93it/s] 94%|#########3| 92/98 [00:51<00:03,  1.84it/s] 95%|#########4| 93/98 [00:52<00:02,  1.87it/s] 96%|#########5| 94/98 [00:52<00:02,  1.90it/s] 97%|#########6| 95/98 [00:53<00:01,  1.92it/s] 98%|#########7| 96/98 [00:53<00:01,  1.93it/s] 99%|#########8| 97/98 [00:54<00:00,  1.85it/s]100%|##########| 98/98 [00:55<00:00,  1.27it/s]100%|##########| 98/98 [00:55<00:00,  1.76it/s]Epoch: [0][ 0/98]	Time  3.798 ( 3.798)	Data  1.365 ( 1.365)	Loss 2.754 (2.754)	Acc@1   9.77 (  9.77)	Acc@5  47.27 ( 47.27)
Epoch: [0][10/98]	Time  0.516 ( 0.839)	Data  0.001 ( 0.126)	Loss 2.473 (2.602)	Acc@1   7.03 (  9.18)	Acc@5  49.02 ( 49.01)
Epoch: [0][20/98]	Time  0.517 ( 0.690)	Data  0.001 ( 0.067)	Loss 2.326 (2.493)	Acc@1  12.70 (  9.80)	Acc@5  53.52 ( 49.53)
Epoch: [0][30/98]	Time  0.524 ( 0.638)	Data  0.001 ( 0.046)	Loss 2.322 (2.442)	Acc@1  11.52 ( 10.25)	Acc@5  55.66 ( 50.47)
Epoch: [0][40/98]	Time  0.513 ( 0.610)	Data  0.001 ( 0.035)	Loss 2.285 (2.408)	Acc@1  12.89 ( 10.89)	Acc@5  58.79 ( 51.77)
Epoch: [0][50/98]	Time  0.513 ( 0.594)	Data  0.001 ( 0.028)	Loss 2.259 (2.380)	Acc@1  15.23 ( 11.67)	Acc@5  60.94 ( 53.50)
Epoch: [0][60/98]	Time  0.520 ( 0.583)	Data  0.002 ( 0.024)	Loss 2.226 (2.359)	Acc@1  19.34 ( 12.42)	Acc@5  66.60 ( 55.01)
Epoch: [0][70/98]	Time  0.520 ( 0.575)	Data  0.002 ( 0.021)	Loss 2.210 (2.341)	Acc@1  19.92 ( 13.20)	Acc@5  64.65 ( 56.23)
Epoch: [0][80/98]	Time  0.514 ( 0.569)	Data  0.003 ( 0.019)	Loss 2.213 (2.326)	Acc@1  19.73 ( 13.84)	Acc@5  66.80 ( 57.55)
Epoch: [0][90/98]	Time  0.512 ( 0.565)	Data  0.001 ( 0.017)	Loss 2.174 (2.313)	Acc@1  18.75 ( 14.34)	Acc@5  72.85 ( 58.64)

  0%|          | 0/20 [00:00<?, ?it/s]                                        0%|          | 0/20 [00:00<?, ?it/s]  5%|5         | 1/20 [00:00<00:13,  1.41it/s] 10%|#         | 2/20 [00:01<00:11,  1.59it/s] 15%|#5        | 3/20 [00:01<00:10,  1.68it/s] 20%|##        | 4/20 [00:02<00:09,  1.71it/s] 25%|##5       | 5/20 [00:02<00:07,  1.89it/s] 30%|###       | 6/20 [00:03<00:06,  2.04it/s] 35%|###5      | 7/20 [00:03<00:06,  2.06it/s] 40%|####      | 8/20 [00:04<00:06,  1.97it/s] 45%|####5     | 9/20 [00:04<00:05,  1.91it/s] 50%|#####     | 10/20 [00:05<00:05,  1.87it/s]                                                50%|#####     | 10/20 [00:05<00:05,  1.87it/s] 55%|#####5    | 11/20 [00:05<00:04,  1.83it/s] 60%|######    | 12/20 [00:06<00:04,  1.97it/s] 65%|######5   | 13/20 [00:06<00:03,  2.09it/s] 70%|#######   | 14/20 [00:07<00:02,  2.19it/s] 75%|#######5  | 15/20 [00:07<00:02,  2.25it/s] 80%|########  | 16/20 [00:08<00:01,  2.31it/s] 85%|########5 | 17/20 [00:08<00:01,  2.34it/s] 90%|######### | 18/20 [00:08<00:00,  2.37it/s] 95%|#########5| 19/20 [00:09<00:00,  2.39it/s]100%|##########| 20/20 [00:09<00:00,  2.18it/s]100%|##########| 20/20 [00:09<00:00,  2.02it/s]Test: [ 0/20]	Time  1.027 ( 1.027)	Loss 2.170 (2.170)	Acc@1  19.53 ( 19.53)	Acc@5  71.88 ( 71.88)
Test: [10/20]	Time  0.577 ( 0.572)	Loss 2.195 (2.178)	Acc@1  17.58 ( 19.58)	Acc@5  68.16 ( 70.05)
Test: [20/20]	Time  0.552 ( 0.507)	Loss 2.182 (2.178)	Acc@1  19.49 ( 19.28)	Acc@5  69.12 ( 70.04)
==> New best, saving at runs/resnet18-usc-unsigned/scores_open/prune_rate=0.5/3/checkpoints/model_best.pth
Overall Timing[0/1]	epoch_time 1.2203 (1.2203)	validation_time 0.1731 (0.1731)	train_time 0.9357 (0.9357)
开始用分数正则化微调
=> Freezing model subnet
==> No gradient to module.conv1.scores
==> Setting gradient of module.conv1.scores to None
==> No gradient to module.layer1.0.conv1.scores
==> Setting gradient of module.layer1.0.conv1.scores to None
==> No gradient to module.layer1.0.conv2.scores
==> Setting gradient of module.layer1.0.conv2.scores to None
==> No gradient to module.layer1.1.conv1.scores
==> Setting gradient of module.layer1.1.conv1.scores to None
==> No gradient to module.layer1.1.conv2.scores
==> Setting gradient of module.layer1.1.conv2.scores to None
==> No gradient to module.layer2.0.conv1.scores
==> Setting gradient of module.layer2.0.conv1.scores to None
==> No gradient to module.layer2.0.conv2.scores
==> Setting gradient of module.layer2.0.conv2.scores to None
==> No gradient to module.layer2.0.shortcut.0.scores
==> Setting gradient of module.layer2.0.shortcut.0.scores to None
==> No gradient to module.layer2.1.conv1.scores
==> Setting gradient of module.layer2.1.conv1.scores to None
==> No gradient to module.layer2.1.conv2.scores
==> Setting gradient of module.layer2.1.conv2.scores to None
==> No gradient to module.layer3.0.conv1.scores
==> Setting gradient of module.layer3.0.conv1.scores to None
==> No gradient to module.layer3.0.conv2.scores
==> Setting gradient of module.layer3.0.conv2.scores to None
==> No gradient to module.layer3.0.shortcut.0.scores
==> Setting gradient of module.layer3.0.shortcut.0.scores to None
==> No gradient to module.layer3.1.conv1.scores
==> Setting gradient of module.layer3.1.conv1.scores to None
==> No gradient to module.layer3.1.conv2.scores
==> Setting gradient of module.layer3.1.conv2.scores to None
==> No gradient to module.layer4.0.conv1.scores
==> Setting gradient of module.layer4.0.conv1.scores to None
==> No gradient to module.layer4.0.conv2.scores
==> Setting gradient of module.layer4.0.conv2.scores to None
==> No gradient to module.layer4.0.shortcut.0.scores
==> Setting gradient of module.layer4.0.shortcut.0.scores to None
==> No gradient to module.layer4.1.conv1.scores
==> Setting gradient of module.layer4.1.conv1.scores to None
==> No gradient to module.layer4.1.conv2.scores
==> Setting gradient of module.layer4.1.conv2.scores to None
==> No gradient to module.fc.scores
==> Setting gradient of module.fc.scores to None
=> Unfreezing model weights
==> Gradient to module.conv1.weight
==> Gradient to module.layer1.0.conv1.weight
==> Gradient to module.layer1.0.conv2.weight
==> Gradient to module.layer1.1.conv1.weight
==> Gradient to module.layer1.1.conv2.weight
==> Gradient to module.layer2.0.conv1.weight
==> Gradient to module.layer2.0.conv2.weight
==> Gradient to module.layer2.0.shortcut.0.weight
==> Gradient to module.layer2.1.conv1.weight
==> Gradient to module.layer2.1.conv2.weight
==> Gradient to module.layer3.0.conv1.weight
==> Gradient to module.layer3.0.conv2.weight
==> Gradient to module.layer3.0.shortcut.0.weight
==> Gradient to module.layer3.1.conv1.weight
==> Gradient to module.layer3.1.conv2.weight
==> Gradient to module.layer4.0.conv1.weight
==> Gradient to module.layer4.0.conv2.weight
==> Gradient to module.layer4.0.shortcut.0.weight
==> Gradient to module.layer4.1.conv1.weight
==> Gradient to module.layer4.1.conv2.weight
==> Gradient to module.fc.weight
=> Using trainer from trainers.default

  0%|          | 0/98 [00:00<?, ?it/s]                                        0%|          | 0/98 [00:00<?, ?it/s]  1%|1         | 1/98 [00:00<01:12,  1.33it/s]  2%|2         | 2/98 [00:01<00:57,  1.67it/s]  3%|3         | 3/98 [00:01<00:52,  1.82it/s]  4%|4         | 4/98 [00:02<01:00,  1.56it/s]  5%|5         | 5/98 [00:03<00:54,  1.69it/s]  6%|6         | 6/98 [00:03<00:51,  1.79it/s]  7%|7         | 7/98 [00:04<00:48,  1.86it/s]  8%|8         | 8/98 [00:04<00:47,  1.91it/s]  9%|9         | 9/98 [00:05<00:51,  1.72it/s] 10%|#         | 10/98 [00:05<00:48,  1.81it/s]                                                10%|#         | 10/98 [00:06<00:48,  1.81it/s] 11%|#1        | 11/98 [00:06<00:54,  1.60it/s] 12%|#2        | 12/98 [00:06<00:50,  1.71it/s] 13%|#3        | 13/98 [00:07<00:47,  1.79it/s] 14%|#4        | 14/98 [00:07<00:45,  1.86it/s] 15%|#5        | 15/98 [00:08<00:49,  1.68it/s] 16%|#6        | 16/98 [00:09<00:46,  1.77it/s] 17%|#7        | 17/98 [00:09<00:43,  1.84it/s] 18%|#8        | 18/98 [00:10<00:49,  1.62it/s] 19%|#9        | 19/98 [00:10<00:45,  1.72it/s] 20%|##        | 20/98 [00:11<00:43,  1.81it/s]                                                20%|##        | 20/98 [00:11<00:43,  1.81it/s] 21%|##1       | 21/98 [00:11<00:41,  1.86it/s] 22%|##2       | 22/98 [00:12<00:39,  1.92it/s] 23%|##3       | 23/98 [00:13<00:43,  1.71it/s] 24%|##4       | 24/98 [00:13<00:40,  1.81it/s] 26%|##5       | 25/98 [00:14<00:38,  1.88it/s] 27%|##6       | 26/98 [00:14<00:37,  1.92it/s] 28%|##7       | 27/98 [00:15<00:41,  1.72it/s] 29%|##8       | 28/98 [00:15<00:38,  1.81it/s] 30%|##9       | 29/98 [00:16<00:36,  1.88it/s] 31%|###       | 30/98 [00:16<00:35,  1.93it/s]                                                31%|###       | 30/98 [00:17<00:35,  1.93it/s] 32%|###1      | 31/98 [00:17<00:34,  1.96it/s] 33%|###2      | 32/98 [00:18<00:37,  1.74it/s] 34%|###3      | 33/98 [00:18<00:35,  1.83it/s] 35%|###4      | 34/98 [00:18<00:33,  1.89it/s] 36%|###5      | 35/98 [00:19<00:32,  1.94it/s] 37%|###6      | 36/98 [00:19<00:31,  1.98it/s] 38%|###7      | 37/98 [00:20<00:35,  1.72it/s] 39%|###8      | 38/98 [00:21<00:33,  1.80it/s] 40%|###9      | 39/98 [00:21<00:31,  1.87it/s] 41%|####      | 40/98 [00:22<00:35,  1.65it/s]                                                41%|####      | 40/98 [00:22<00:35,  1.65it/s] 42%|####1     | 41/98 [00:22<00:32,  1.75it/s] 43%|####2     | 42/98 [00:23<00:35,  1.57it/s] 44%|####3     | 43/98 [00:24<00:32,  1.68it/s] 45%|####4     | 44/98 [00:24<00:30,  1.77it/s] 46%|####5     | 45/98 [00:25<00:28,  1.84it/s] 47%|####6     | 46/98 [00:25<00:31,  1.67it/s] 48%|####7     | 47/98 [00:26<00:29,  1.75it/s] 49%|####8     | 48/98 [00:26<00:27,  1.83it/s] 50%|#####     | 49/98 [00:27<00:30,  1.63it/s] 51%|#####1    | 50/98 [00:28<00:27,  1.73it/s]                                                51%|#####1    | 50/98 [00:28<00:27,  1.73it/s] 52%|#####2    | 51/98 [00:28<00:26,  1.81it/s] 53%|#####3    | 52/98 [00:29<00:24,  1.85it/s] 54%|#####4    | 53/98 [00:29<00:27,  1.66it/s] 55%|#####5    | 54/98 [00:30<00:25,  1.76it/s] 56%|#####6    | 55/98 [00:30<00:23,  1.83it/s] 57%|#####7    | 56/98 [00:31<00:25,  1.65it/s] 58%|#####8    | 57/98 [00:32<00:23,  1.75it/s] 59%|#####9    | 58/98 [00:32<00:21,  1.83it/s] 60%|######    | 59/98 [00:33<00:20,  1.88it/s] 61%|######1   | 60/98 [00:33<00:22,  1.68it/s]                                                61%|######1   | 60/98 [00:34<00:22,  1.68it/s] 62%|######2   | 61/98 [00:34<00:20,  1.77it/s] 63%|######3   | 62/98 [00:34<00:19,  1.83it/s] 64%|######4   | 63/98 [00:35<00:21,  1.63it/s] 65%|######5   | 64/98 [00:36<00:19,  1.73it/s] 66%|######6   | 65/98 [00:36<00:18,  1.81it/s] 67%|######7   | 66/98 [00:37<00:17,  1.87it/s] 68%|######8   | 67/98 [00:37<00:18,  1.65it/s] 69%|######9   | 68/98 [00:38<00:17,  1.75it/s] 70%|#######   | 69/98 [00:38<00:15,  1.83it/s] 71%|#######1  | 70/98 [00:39<00:16,  1.65it/s]                                                71%|#######1  | 70/98 [00:40<00:16,  1.65it/s] 72%|#######2  | 71/98 [00:40<00:15,  1.75it/s] 73%|#######3  | 72/98 [00:40<00:14,  1.82it/s] 74%|#######4  | 73/98 [00:41<00:13,  1.87it/s] 76%|#######5  | 74/98 [00:41<00:14,  1.69it/s] 77%|#######6  | 75/98 [00:42<00:12,  1.78it/s] 78%|#######7  | 76/98 [00:42<00:11,  1.84it/s] 79%|#######8  | 77/98 [00:43<00:12,  1.63it/s] 80%|#######9  | 78/98 [00:44<00:12,  1.64it/s] 81%|########  | 79/98 [00:45<00:13,  1.45it/s] 82%|########1 | 80/98 [00:45<00:11,  1.58it/s]                                                82%|########1 | 80/98 [00:46<00:11,  1.58it/s] 83%|########2 | 81/98 [00:46<00:11,  1.42it/s] 84%|########3 | 82/98 [00:47<00:11,  1.39it/s] 85%|########4 | 83/98 [00:47<00:10,  1.43it/s] 86%|########5 | 84/98 [00:48<00:09,  1.41it/s] 87%|########6 | 85/98 [00:49<00:08,  1.46it/s] 88%|########7 | 86/98 [00:49<00:08,  1.47it/s] 89%|########8 | 87/98 [00:50<00:06,  1.64it/s] 90%|########9 | 88/98 [00:50<00:05,  1.80it/s] 91%|######### | 89/98 [00:51<00:04,  1.91it/s] 92%|#########1| 90/98 [00:51<00:03,  2.01it/s]                                                92%|#########1| 90/98 [00:52<00:03,  2.01it/s] 93%|#########2| 91/98 [00:52<00:03,  2.08it/s] 94%|#########3| 92/98 [00:52<00:02,  2.13it/s] 95%|#########4| 93/98 [00:53<00:02,  2.17it/s] 96%|#########5| 94/98 [00:53<00:01,  2.21it/s] 97%|#########6| 95/98 [00:53<00:01,  2.22it/s] 98%|#########7| 96/98 [00:54<00:00,  2.24it/s] 99%|#########8| 97/98 [00:54<00:00,  2.25it/s]100%|##########| 98/98 [00:55<00:00,  2.23it/s]100%|##########| 98/98 [00:55<00:00,  1.77it/s]Epoch: [1][ 0/98]	Time  1.050 ( 1.050)	Data  0.462 ( 0.462)	Loss 2.425 (2.425)	Acc@1  11.52 ( 11.52)	Acc@5  52.73 ( 52.73)
Epoch: [1][10/98]	Time  0.788 ( 0.615)	Data  0.069 ( 0.102)	Loss 2.539 (2.442)	Acc@1   9.18 ( 11.35)	Acc@5  48.24 ( 51.81)
Epoch: [1][20/98]	Time  0.500 ( 0.582)	Data  0.070 ( 0.083)	Loss 2.477 (2.446)	Acc@1  10.55 ( 11.68)	Acc@5  50.59 ( 51.45)
Epoch: [1][30/98]	Time  0.491 ( 0.567)	Data  0.070 ( 0.077)	Loss 2.478 (2.452)	Acc@1  10.16 ( 11.50)	Acc@5  49.61 ( 51.08)
Epoch: [1][40/98]	Time  0.491 ( 0.567)	Data  0.068 ( 0.073)	Loss 2.494 (2.455)	Acc@1   9.57 ( 11.16)	Acc@5  48.44 ( 50.93)
Epoch: [1][50/98]	Time  0.501 ( 0.569)	Data  0.070 ( 0.071)	Loss 2.414 (2.451)	Acc@1  13.67 ( 11.21)	Acc@5  52.93 ( 51.21)
Epoch: [1][60/98]	Time  0.428 ( 0.569)	Data  0.002 ( 0.069)	Loss 2.441 (2.448)	Acc@1  11.13 ( 11.42)	Acc@5  54.88 ( 51.45)
Epoch: [1][70/98]	Time  0.493 ( 0.570)	Data  0.069 ( 0.069)	Loss 2.419 (2.447)	Acc@1  12.30 ( 11.45)	Acc@5  55.66 ( 51.51)
Epoch: [1][80/98]	Time  0.864 ( 0.578)	Data  0.065 ( 0.068)	Loss 2.442 (2.447)	Acc@1  12.89 ( 11.42)	Acc@5  51.76 ( 51.48)
Epoch: [1][90/98]	Time  0.447 ( 0.576)	Data  0.070 ( 0.068)	Loss 2.483 (2.448)	Acc@1   9.57 ( 11.38)	Acc@5  50.39 ( 51.45)

  0%|          | 0/20 [00:00<?, ?it/s]                                        0%|          | 0/20 [00:00<?, ?it/s]  5%|5         | 1/20 [00:00<00:15,  1.24it/s] 10%|#         | 2/20 [00:01<00:12,  1.48it/s] 15%|#5        | 3/20 [00:01<00:10,  1.62it/s] 20%|##        | 4/20 [00:02<00:08,  1.84it/s] 25%|##5       | 5/20 [00:02<00:07,  1.98it/s] 30%|###       | 6/20 [00:03<00:06,  2.08it/s] 35%|###5      | 7/20 [00:03<00:06,  2.16it/s] 40%|####      | 8/20 [00:04<00:05,  2.22it/s] 45%|####5     | 9/20 [00:04<00:04,  2.25it/s] 50%|#####     | 10/20 [00:04<00:04,  2.26it/s]                                                50%|#####     | 10/20 [00:05<00:04,  2.26it/s] 55%|#####5    | 11/20 [00:05<00:03,  2.26it/s] 60%|######    | 12/20 [00:05<00:03,  2.28it/s] 65%|######5   | 13/20 [00:06<00:03,  2.29it/s] 70%|#######   | 14/20 [00:06<00:02,  2.29it/s] 75%|#######5  | 15/20 [00:07<00:02,  2.30it/s] 80%|########  | 16/20 [00:07<00:01,  2.30it/s] 85%|########5 | 17/20 [00:07<00:01,  2.30it/s] 90%|######### | 18/20 [00:08<00:00,  2.30it/s] 95%|#########5| 19/20 [00:08<00:00,  2.31it/s]100%|##########| 20/20 [00:09<00:00,  2.34it/s]100%|##########| 20/20 [00:09<00:00,  2.14it/s]
Test: [ 0/20]	Time  1.341 ( 1.341)	Loss 2.416 (2.416)	Acc@1   8.59 (  8.59)	Acc@5  51.37 ( 51.37)
Test: [10/20]	Time  0.443 ( 0.540)	Loss 2.411 (2.397)	Acc@1  10.35 ( 10.14)	Acc@5  49.61 ( 50.71)
Test: [20/20]	Time  0.417 ( 0.491)	Loss 2.358 (2.397)	Acc@1   9.56 ( 10.00)	Acc@5  52.57 ( 50.67)
==> New best, saving at runs/resnet18-usc-unsigned/scores_open/prune_rate=0.5/3/checkpoints/model_best.pth
Overall Timing[1/1]	epoch_time 1.2203 (1.2203)	validation_time 0.1731 (0.1731)	train_time 0.9357 (0.9357)
wandb: - 0.022 MB of 0.022 MB uploadedwandb: \ 0.028 MB of 0.152 MB uploadedwandb: | 0.150 MB of 0.152 MB uploadedwandb: / 0.150 MB of 0.152 MB uploadedwandb: - 0.152 MB of 0.152 MB uploadedwandb: 
wandb: Run history:
wandb:            epoch ▁█
wandb:  epoch_test_acc1 █▁
wandb:  epoch_test_acc5 █▁
wandb: epoch_train_acc1 █▁
wandb: epoch_train_acc5 █▁
wandb:   iter_test_acc1 █▁
wandb:   iter_test_acc5 █▁
wandb:   iter_test_loss ▁█
wandb:  iter_train_acc1 ▁▄▁▂▂▂▂▃▃▄▄▅▅▆▇▆█▆▅▇▂▃▃▃▂▃▂▁▃▃▂▃▂▃▂▂▃▃▃▄
wandb:  iter_train_acc5 ▁▂▂▂▃▃▃▄▅▅▅▅▇▆█▇█▇██▃▃▂▂▂▂▂▂▄▂▃▂▂▃▂▁▃▃▃▂
wandb:  iter_train_loss █▅▄▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▄▄▄▄
wandb: 
wandb: Run summary:
wandb:            epoch 1
wandb:  epoch_test_acc1 10.0
wandb:  epoch_test_acc5 50.67
wandb: epoch_train_acc1 11.414
wandb: epoch_train_acc5 51.456
wandb:   iter_test_acc1 9.55882
wandb:   iter_test_acc5 52.57353
wandb:   iter_test_loss 2.35759
wandb:  iter_train_acc1 13.39286
wandb:  iter_train_acc5 50.29762
wandb:  iter_train_loss 2.42606
wandb: 
wandb: 🚀 View run open_finetune_1e-05_unif_0.5_CIFAR10_cResNet18_512_1 at: https://wandb.ai/ycx/EP%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92/runs/hl1fk7gm
wandb: ⭐️ View project at: https://wandb.ai/ycx/EP%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92
wandb: Synced 6 W&B file(s), 1 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241011_161159-hl1fk7gm/logs
